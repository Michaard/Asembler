T0_VAL EQU (65535-46080)
TL0_VAL EQU (T0_VAL mod 256)
TH0_VAL EQU (T0_VAL/256)
CSDB16 EQU 0FF38h
CSDS16 EQU 0FF30h

ORG 0000h
_RESET:
	LJMP _INIT

ORG 0Bh
_INT_T0:
	ORL TL0,#TL0_VAL
	MOV TH0,#TH0_VAL
	INC _COUNTER
	RETI

ORG 0100h
_INIT:
	MOV TL0,#TL0_VAL
	MOV TH0,#TH0_VAL
	ANL TCON,#11001111b
	ANL TMOD,#11110001b
	ORL TMOD,#00000001b
	ORL IE,#10000010b

	MOV _COUNTER,#0d
	MOV _SEC,#0d

	MOV _ID_WSK,#00000001b
	MOV _W1_VAL,#00111111b
	MOV _W2_VAL,#00111111b
	MOV _W3_VAL,#00111111b

	ORL TCON,#00010000b
_LOOP:
	MOV A,_COUNTER
	CJNE A,#20d,_CD
	MOV _COUNTER,#0d
	INC _SEC
	LCALL _SPLIT
	CPL _LED
_CD:
	LCALL _REFRESH
	LJMP _LOOP

_SPLIT:
	MOV A,_SEC
	MOV B,#10d
	DIV AB
	MOV _W1_VAL,B
	MOV B,#10d
	DIV AB
	MOV _W2_VAL,B
	MOV _W3_VAL,A
	RET
	
_REFRESH:
	MOV A,_ID_WSK
	RL A
	MOV _ID_WSK,A
	CJNE A,#00001000b,_W1
	MOV _ID_WSK,#00000001b
	MOV A,_ID_WSK
;tutaj nalezy wstawic (przed _AKCJE_KONCOWE) trzy warunki odpowiedzialne za wyswietlanie odpowiedniej wartosci
;na wyswietlaczu (wykorzystac wartosci z _W1_VAL,_W2_VAL i _W3_VAL) oraz zapisaÄ‡ je do rejestru R0
_AKCJE_KONCOWE:
    SETB _WYSW
	MOV A,_ID_WSK
    MOV DPTR,#CSDS16
	MOVX @DPTR,A
    MOV A,R0
	MOV DPTR,#CSDB16
	MOVX @DPTR,A
	CLR _WYSW
	RET
END